% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/implicit_forecast.R
\name{implicit_forecast}
\alias{implicit_forecast}
\title{Retrieve implicit forecasts corresponding to the asymmetric filters}
\usage{
implicit_forecast(x, coefs)
}
\arguments{
\item{x}{a univariate or multivariate time series.}

\item{coefs}{a \code{matrix} or a \code{list} that contains all the coefficients of the asymmetric and symmetric filters.
(from the symmetric filter to the shortest). See details.}
}
\description{
Function to retrieve the implicit forecasts corresponding to the asymmetric filters
}
\details{
Let \eqn{h} be the bandwidth of the symmetric filter,
\eqn{v_{-h}, \ldots, v_h} the coefficients of the symmetric filter and
\eqn{w_{-h}^q, \ldots, w_h^q} the coefficients of the asymmetric filter used to estimate
the trend when \eqn{q} future values are known (with the convention \eqn{w_{q+1}^q=\ldots=w_h^q=0}).
Let denote \eqn{y_{-h},\ldots, y_0} the las \eqn{h} available values of the input times series.
Let also note \eqn{y_{-h},\ldots,y_{0}} the observed series studied and \eqn{y_{1}^*,\dots y_h^*}the implicit forecast induced by \eqn{w^0,\dots w^{h-1}}.
This means that e:
\deqn{
\forall q, \quad \sum_{i=-h}^0 v_iy_i + \sum_{i=1}^h v_iy_i^*
=\sum_{i=-h}^0 w_i^qy_i + \sum_{i=1}^h w_i^qy_i^*
}
which is equivalent to
\deqn{
\forall q, \sum_{i=1}^h (v_i- w_i^q) y_i^*
=\sum_{i=-h}^0 (w_i^q-v_i)y_i.
}
Note that this is solved numerically: the solution isn't exact.
}
\examples{
x <- retailsa$AllOtherGenMerchandiseStores
ql <- lp_filter(horizon = 6, kernel = "Henderson", endpoints = "QL")
lc <- lp_filter(horizon = 6, kernel = "Henderson", endpoints = "LC")
f_ql <- implicit_forecast(x, ql)
f_lc <- implicit_forecast(x, lc)

plot(window(x, start = 2007),
     xlim = c(2007,2012))
lines(ts(c(tail(x,1), f_ql), frequency = frequency(x), start = end(x)),
      col = "red", lty = 2)
lines(ts(c(tail(x,1), f_lc), frequency = frequency(x), start = end(x)),
      col = "blue", lty = 2)
}
